1.Total spending per month
SELECT 
    Month,
    SUM(ValueAmount) AS total_spent
FROM transactions
GROUP BY Month
ORDER BY Month;


2. Total spending per category
SELECT
    TransactionCategory,
    SUM(ValueAmount) AS total_spent
FROM transactions
GROUP BY TransactionCategory
ORDER BY total_spent DESC;


3. Monthly breakdown by category
SELECT
    Month,
    TransactionCategory,
    SUM(Amount) AS total_spent
FROM transactions
GROUP BY Month, TransactionCategory
ORDER BY Month, total_spent DESC;


4. Months where I overspent vs my average
WITH monthly AS (
    SELECT
        Month,
        SUM(Amount) AS total_spent
    FROM transactions
    GROUP BY Month
),
avg_spend AS (
    SELECT AVG(total_spent) AS avg_monthly_spend
    FROM monthly
)
SELECT
    m.Month,
    m.total_spent,
    a.avg_monthly_spend,
    CASE 
        WHEN m.total_spent > a.avg_monthly_spend THEN 'Above Average'
        ELSE 'Below or Equal to Average'
    END AS spending_flag
FROM monthly m
CROSS JOIN avg_spend a
ORDER BY m.Month;


5. Top 3 highest individual expenses
SELECT
    Month,
    TransactionCategory,
    Amount
FROM transactions
ORDER BY Amount DESC
LIMIT 3;
